<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <!-- load the d3.js library -->
    <script src="http://d3js.org/d3.v3.min.js"></script>
    <script src="d3.layout.cloud.js"></script>
    <script src="wordCountMapping_all.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.0/jquery.min.js"></script>
    <link rel="stylesheet" href="../main.css"/>

  </head>

  <body>
    <div class="page">
        <h1>Frequently used words</h1>
        <div class="menu-header">
          <ul class="menu-header-links">
            <li class="menu-button selected"><a class="menu-button selected" href="http://data-visualisation.semic.eu:8890/TransparencyRegister/wordcloud.html">Eu activities focus</a></li>
                <li class="menu-button"><a class="menu-button" href="http://data-visualisation.semic.eu:8890/TransparencyRegister/bubble.html">Fields of interest</a></li>
                <li class="menu-button"><a class="menu-button" href="http://data-visualisation.semic.eu:8890/TransparencyRegister/lineChart.html">Evolution of registrations</a></li>
                <li class="menu-button"><a class="menu-button" href="http://data-visualisation.semic.eu:8890/TransparencyRegister/leafletMap.html">Distribution of registrants</a></li>
          </ul>
        </div>

        <div class="explanation">
          Add an explanation here.
        </div>
          
      <div class="content">
<!--         <div style="float:left;">
          <div style="text-align: justify; font-family:arial;">
            Select an option:
          </div>
        </div>
        <div style="float:left;">
          <select id="dataDropdown" onchange="dataSelected(this)" style="margin-left:10px;">
            <option value="goal_one">goal: one word</option>
            <option value="activity_one">activity: one word</option>
            <option value="both_one">goals and activities: one word</option>
            <option value="goal_two">goal: two words</option>
            <option value="activity_two">activity: two words</option>
            <option value="both_two">goals and activities: two words</option>
          </select>
        </div> -->
        <div id="chart_div"></div>
      </div>

      <div class="footer">
        This visualisation has been developed by  <a href="http://www.pwc.be/" target="_blank">PwC EU services</a> for the <a href="http://publications.europa.eu/en/home" target="_blank">Publications Office of the EU</a>
        uusing <a href="https://developers.google.com/chart/interactive/docs/gallery/linechart" target="_blank">the Google-visualization library</a>
        and is based on datasets provided on the <a href="http://ec.europa.eu/transparencyregister/public/homePage.do" target="_blank">Transparency Register</a>.
        <br><br>
        The source code of this visualisation can be found on the following <a href="https://github.com/SEMICeu/data-visualisation-pilot" target="_blank">Github repository</a>.
      </div>
    </div>

<script>

   var currentData;

   function D3ok() {
      var myNode = document.getElementById("chart_div");
      while (myNode.firstChild) {
         myNode.removeChild(myNode.firstChild);
      }

      var wordsList = data["wordsList_"+currentData];
      var wordCountMapping = data["wordCountMapping_"+currentData];

      var fill = d3.scale.category20();

      var layout = d3.layout.cloud()
          .size([900, 600])
          .timeInterval(20)
          .words(wordsList.map(function(d) {
            return {text: d, size: wordCountMapping[d]/40, test: "haha"};
          }))
          //.padding(5)
          .rotate(function() { return ~~(Math.random() * 2) * 90; })
          .font("Impact")
          .fontSize(function(d) { return d.size; })
          .spiral("archimedean")
          .on("end", draw);

      layout.start();

      function draw(words) {
        d3.select("#chart_div").append("svg")
            .attr("width", layout.size()[0])
            .attr("height", layout.size()[1])
          .append("g")
            .attr("transform", "translate(" + layout.size()[0] / 2 + "," + layout.size()[1] / 2 + ")")
          .selectAll("text")
            .data(words)
          .enter().append("text")
            .style("font-size", function(d) { return d.size + "px"; })
            .style("font-family", "Impact")
            .style("fill", function(d, i) { return fill(i); })
            .attr("text-anchor", "middle")
            .attr("transform", function(d) {
              return "translate(" + [d.x, d.y] + ")rotate(" + d.rotate + ")";
            })
            .text(function(d) { return d.text; });
      }
   }    

function dataSelected(option) {
  console.log("here");
  currentData = option.value;
  D3ok();
}

$(document).ready(function() { 
   currentData="activity_two";
   D3ok();
});
</script>


  </body>
</html>
